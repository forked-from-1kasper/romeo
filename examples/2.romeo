predicate isLeftCancellable (C : U) (a : C) (b : C) (f : Hom C a b) (t : C) :=
âˆ€ (h k : Hom C t a), f âˆ˜ h = f âˆ˜ k âŠƒ h = k

predicate monic (C : U) (a : C) (b : C) (f : Hom C a b) :=
âˆ€ (t : C), isLeftCancellable C a b f t

predicate isRightCancellable (C : U) (a : C) (b : C) (f : Hom C a b) (t : C) :=
âˆ€ (h k : Hom C b t), h âˆ˜ f = k âˆ˜ f âŠƒ h = k

predicate epic (C : U) (a : C) (b : C) (f : Hom C a b) :=
âˆ€ (t : C), isRightCancellable C a b f t

predicate splitEpic (C : U) (a : C) (b : C) (f : Hom C a b) :=
âˆƒ (g : Hom C b a), f âˆ˜ g = id b

predicate isInverse (C : U) (a : C) (b : C) (f : Hom C a b) (g : Hom C b a) :=
f âˆ˜ g = id b âˆ§ g âˆ˜ f = id a

predicate iso (C : U) (a : C) (b : C) (f : Hom C a b) :=
âˆƒ (g : Hom C b a), isInverse C a b f g

predicate balanced (C : U) :=
âˆ€ (a b : C) (f : Hom C a b), monic C a b f âŠƒ epic C a b f âŠƒ iso C a b f

constants ðŸ : U
constants 0 : ðŸ
constants 1 : ðŸ
constants Î± : Hom ðŸ 0 1

axiom ðŸ-ob : âˆ€ (b : ðŸ), b = 0 âˆ¨ b = 1
axiom ðŸ-id : âˆ€ (b : ðŸ) (g : Hom ðŸ b b), g = id b
axiom ðŸ-Î±â‚ : âˆ€ (g : Hom ðŸ 0 1), g = Î±
axiom ðŸ-Î±â‚‚ : âˆ€ (g : Hom ðŸ 1 0), âŠ¥

lemma Î±-monic : monic ðŸ 0 1 Î± :=
Î» t, have H : t = 0 âˆ¨ t = 1 => âˆ€-elim ðŸ-ob t in
  âˆ¨-elim H
    (Î» Hâ€², have Hâ€³ : 0 = t => symm Hâ€² in
      subst tâ€² (isLeftCancellable ðŸ 0 1 Î± tâ€²) Hâ€³
        (Î» h k G,
          have Gâ€² : h = id 0 => âˆ€-elim ðŸ-id 0 h in
          have Gâ€³ : id 0 = k => symm (âˆ€-elim ðŸ-id 0 k) in
          trans Gâ€² Gâ€³))
    (Î» Hâ€², have Hâ€³ : 1 = t => symm Hâ€² in
      subst tâ€² (isLeftCancellable ðŸ 0 1 Î± tâ€²) Hâ€³
        (Î» g, absurd (âˆ€-elim ðŸ-Î±â‚‚ g)))

lemma Î±-epic : epic ðŸ 0 1 Î± :=
Î» t, have H : t = 0 âˆ¨ t = 1 => âˆ€-elim ðŸ-ob t in
  âˆ¨-elim H
    (Î» Hâ€², have Hâ€³ : 0 = t => symm Hâ€² in
      subst tâ€² (isRightCancellable ðŸ 0 1 Î± tâ€²) Hâ€³
        (Î» g, absurd (âˆ€-elim ðŸ-Î±â‚‚ g)))
    (Î» Hâ€², have Hâ€³ : 1 = t => symm Hâ€² in
      subst tâ€² (isRightCancellable ðŸ 0 1 Î± tâ€²) Hâ€³
        (Î» h k G,
          have Gâ€² : h = id 1 => âˆ€-elim ðŸ-id 1 h in
          have Gâ€³ : id 1 = k => symm (âˆ€-elim ðŸ-id 1 k) in
          trans Gâ€² Gâ€³))

lemma Î±-not-iso : Â¬(iso ðŸ 0 1 Î±) :=
Î» H, âˆƒ-elim H (Î» g _, âˆ€-elim ðŸ-Î±â‚‚ g)

lemma Î±-not-split-epic : Â¬(splitEpic ðŸ 0 1 Î±) :=
Î» H, âˆƒ-elim H (Î» g _, âˆ€-elim ðŸ-Î±â‚‚ g)

theorem monic-split-epic-impl-iso : âˆ€ (C : U) (a b : C) (f : Hom C a b),
  monic C a b f âŠƒ splitEpic C a b f âŠƒ iso C a b f :=
Î» C a b f G H,
  âˆƒ-elim H (Î» g Hâ€²,
    have Hâ€³ : id b = f âˆ˜ g => symm Hâ€² in
    have Gâ€² : f âˆ˜ g âˆ˜ f = f âŠƒ g âˆ˜ f = id a => âˆ€-elim G a (g âˆ˜ f) (id a) in
    âˆƒ-intro g (âˆ§-intro Hâ€² (Gâ€² (subst h (h âˆ˜ f = f) Hâ€³ (refl f)))))
